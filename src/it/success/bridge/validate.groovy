new GroovyScriptEngine(basedir.parentFile.parent)
  .loadScriptByName('Validate.groovy')
  .newInstance(basedir)
  .log()
def root = new File(basedir, buildDirectory).toPath()
def actual = java.nio.file.Files.walk(root).withCloseable{
  it.filter{ !java.nio.file.Files.isDirectory(it) }
    .map{ root.relativize(it) }
    .map{ it.toString() }
    .collect(java.util.stream.Collectors.toSet())
}
def expected = [
  'classes/A.class',
  'zinc/analysis/compile',
  'zinc/classes/scala/ZincCompat$.class',
  'zinc/classes/scala/ZincCompat.class',
  'zinc/classes/xsbt/API$.class',
  'zinc/classes/xsbt/API$ApiPhase.class',
  'zinc/classes/xsbt/API$FlattenedNames$.class',
  'zinc/classes/xsbt/API$FlattenedNames.class',
  'zinc/classes/xsbt/API$TopLevelHandler.class',
  'zinc/classes/xsbt/API$TopLevelTraverser.class',
  'zinc/classes/xsbt/API.class',
  'zinc/classes/xsbt/AbstractZincFile$.class',
  'zinc/classes/xsbt/AbstractZincFile.class',
  'zinc/classes/xsbt/Analyzer$.class',
  'zinc/classes/xsbt/Analyzer$AnalyzerPhase.class',
  'zinc/classes/xsbt/Analyzer.class',
  'zinc/classes/xsbt/CachedCompiler0$Compat$1.class',
  'zinc/classes/xsbt/CachedCompiler0$CondWarnCompat$1.class',
  'zinc/classes/xsbt/CachedCompiler0.class',
  'zinc/classes/xsbt/CachedCompilerCompat.class',
  'zinc/classes/xsbt/CallbackGlobal.class',
  'zinc/classes/xsbt/ClassName.class',
  'zinc/classes/xsbt/Compat$.class',
  'zinc/classes/xsbt/Compat.class',
  'zinc/classes/xsbt/CompilerBridge.class',
  'zinc/classes/xsbt/ConsoleBridge$$anon$1$$anon$2.class',
  'zinc/classes/xsbt/ConsoleBridge$$anon$1.class',
  'zinc/classes/xsbt/ConsoleBridge.class',
  'zinc/classes/xsbt/DelegatingReporter$.class',
  'zinc/classes/xsbt/DelegatingReporter$CompileProblem.class',
  'zinc/classes/xsbt/DelegatingReporter$PositionImpl$.class',
  'zinc/classes/xsbt/DelegatingReporter$PositionImpl.class',
  'zinc/classes/xsbt/DelegatingReporter.class',
  'zinc/classes/xsbt/Dependency$.class',
  'zinc/classes/xsbt/Dependency$ClassDependency$.class',
  'zinc/classes/xsbt/Dependency$ClassDependency.class',
  'zinc/classes/xsbt/Dependency$DependencyPhase.class',
  'zinc/classes/xsbt/Dependency$DependencyProcessor.class',
  'zinc/classes/xsbt/Dependency$DependencyTraverser$TypeDependencyTraverser$.class',
  'zinc/classes/xsbt/Dependency$DependencyTraverser.class',
  'zinc/classes/xsbt/Dependency.class',
  'zinc/classes/xsbt/ExtractAPI$$anon$1.class',
  'zinc/classes/xsbt/ExtractAPI$$anonfun$1.class',
  'zinc/classes/xsbt/ExtractAPI$.class',
  'zinc/classes/xsbt/ExtractAPI$Constants$.class',
  'zinc/classes/xsbt/ExtractAPI$IsStatic$1.class',
  'zinc/classes/xsbt/ExtractAPI$SuppressSymbolRef.class',
  'zinc/classes/xsbt/ExtractAPI$existentialRenamings$.class',
  'zinc/classes/xsbt/ExtractAPI.class',
  'zinc/classes/xsbt/ExtractUsedNames$ExtractUsedNamesTraverser$PatMatDependencyTraverser$.class',
  'zinc/classes/xsbt/ExtractUsedNames$ExtractUsedNamesTraverser$TypeDependencyTraverser$.class',
  'zinc/classes/xsbt/ExtractUsedNames$ExtractUsedNamesTraverser.class',
  'zinc/classes/xsbt/ExtractUsedNames$NamesUsedInClass.class',
  'zinc/classes/xsbt/ExtractUsedNames.class',
  'zinc/classes/xsbt/GlobalHelpers$Feedback$.class',
  'zinc/classes/xsbt/GlobalHelpers$MacroExpansionOf$$anonfun$unapply$1.class',
  'zinc/classes/xsbt/GlobalHelpers$MacroExpansionOf$.class',
  'zinc/classes/xsbt/GlobalHelpers$TypeDependencyTraverser.class',
  'zinc/classes/xsbt/GlobalHelpers.class',
  'zinc/classes/xsbt/InteractiveConsoleBridge.class',
  'zinc/classes/xsbt/InteractiveConsoleBridgeFactory.class',
  'zinc/classes/xsbt/InteractiveConsoleHelper$.class',
  'zinc/classes/xsbt/InteractiveConsoleHelper.class',
  'zinc/classes/xsbt/InteractiveConsoleResponse$.class',
  'zinc/classes/xsbt/InteractiveConsoleResponse.class',
  'zinc/classes/xsbt/InteractiveMakeSettings$.class',
  'zinc/classes/xsbt/InteractiveMakeSettings.class',
  'zinc/classes/xsbt/InterfaceCompileCancelled.class',
  'zinc/classes/xsbt/InterfaceCompileFailed.class',
  'zinc/classes/xsbt/JarUtils.class',
  'zinc/classes/xsbt/JavaUtils$.class',
  'zinc/classes/xsbt/JavaUtils$JavaForEach$.class',
  'zinc/classes/xsbt/JavaUtils$JavaForEach.class',
  'zinc/classes/xsbt/JavaUtils$JavaMapForEach$.class',
  'zinc/classes/xsbt/JavaUtils$JavaMapForEach.class',
  'zinc/classes/xsbt/JavaUtils.class',
  'zinc/classes/xsbt/LocalToNonLocalClass.class',
  'zinc/classes/xsbt/LocateClassFile.class',
  'zinc/classes/xsbt/Log$.class',
  'zinc/classes/xsbt/Log.class',
  'zinc/classes/xsbt/MakeSettings$.class',
  'zinc/classes/xsbt/MakeSettings.class',
  'zinc/classes/xsbt/Message$$anon$1.class',
  'zinc/classes/xsbt/Message$.class',
  'zinc/classes/xsbt/Message.class',
  'zinc/classes/xsbt/Runner$forScope$.class',
  'zinc/classes/xsbt/Runner$forScope$DocFactory$$anon$1.class',
  'zinc/classes/xsbt/Runner$forScope$DocFactory$compiler$.class',
  'zinc/classes/xsbt/Runner$forScope$DocFactory$compiler$DefaultDocDriver.class',
  'zinc/classes/xsbt/Runner$forScope$DocFactory.class',
  'zinc/classes/xsbt/Runner.class',
  'zinc/classes/xsbt/ScaladocBridge.class',
  'zinc/classes/xsbt/WeakLog.class',
  'zinc/classes/xsbt/ZincCompiler$ZincRun.class',
  'zinc/classes/xsbt/ZincCompiler$apiExtractor$$anonfun$1.class',
  'zinc/classes/xsbt/ZincCompiler$apiExtractor$.class',
  'zinc/classes/xsbt/ZincCompiler$dummy$.class',
  'zinc/classes/xsbt/ZincCompiler$sbtAnalyzer$.class',
  'zinc/classes/xsbt/ZincCompiler$sbtDependency$.class',
  'zinc/classes/xsbt/ZincCompiler.class',
  'zinc/classes/xsbt/ZincCompilerRangePos.class',
  'zinc/classes/xsbt/ZincGlobalCompat.class',
  'zinc/classes/xsbt/ZincPlainFile.class',
  'zinc/classes/xsbt/ZincVirtualFile.class',
  "zinc/org.scala-sbt-compiler-bridge_2.13-1.4.4-bin_2.13.4__${System.getProperty('java.class.version')}-1.4.4_20201220T223045.jar",
  'zinc/sources/META-INF/MANIFEST.MF',
  'zinc/sources/META-INF/services/xsbti.InteractiveConsoleFactory',
  'zinc/sources/META-INF/services/xsbti.compile.CompilerInterface2',
  'zinc/sources/META-INF/services/xsbti.compile.ConsoleInterface1',
  'zinc/sources/META-INF/services/xsbti.compile.ScaladocInterface2',
  'zinc/sources/scala/ZincCompat.scala',
  'zinc/sources/xsbt/API.scala',
  'zinc/sources/xsbt/AbstractZincFile.scala',
  'zinc/sources/xsbt/Analyzer.scala',
  'zinc/sources/xsbt/CallbackGlobal.scala',
  'zinc/sources/xsbt/ClassName.scala',
  'zinc/sources/xsbt/Compat.scala',
  'zinc/sources/xsbt/CompilerBridge.scala',
  'zinc/sources/xsbt/ConsoleBridge.scala',
  'zinc/sources/xsbt/DelegatingReporter.scala',
  'zinc/sources/xsbt/Dependency.scala',
  'zinc/sources/xsbt/ExtractAPI.scala',
  'zinc/sources/xsbt/ExtractUsedNames.scala',
  'zinc/sources/xsbt/GlobalHelpers.scala',
  'zinc/sources/xsbt/InteractiveConsoleBridge.scala',
  'zinc/sources/xsbt/InteractiveConsoleFactoryBridge.scala',
  'zinc/sources/xsbt/InteractiveConsoleHelper.scala',
  'zinc/sources/xsbt/InteractiveConsoleResponse.scala',
  'zinc/sources/xsbt/JarUtils.scala',
  'zinc/sources/xsbt/JavaUtils.scala',
  'zinc/sources/xsbt/LocalToNonLocalClass.scala',
  'zinc/sources/xsbt/LocateClassFile.scala',
  'zinc/sources/xsbt/Log.scala',
  'zinc/sources/xsbt/Message.scala',
  'zinc/sources/xsbt/ScaladocBridge.scala'
] as Set
def unexpected = actual - expected
def missing = expected - actual
assert unexpected == [] as Set && missing == [] as Set
